# è³‡æ–™åº«ç¨®å­æŒ‡å—

## æ¦‚è¿°

æœ¬å°ˆæ¡ˆä½¿ç”¨ Prisma çš„ç¨®å­åŠŸèƒ½ä¾†åˆå§‹åŒ–è³‡æ–™åº«çš„åŸºç¤è³‡æ–™ã€‚ç¨®å­è…³æœ¬ä½æ–¼ [prisma/seed.ts](../prisma/seed.ts)ã€‚

---

## ç¨®å­å…§å®¹

### 1. **ç‰©è³‡é¡åˆ¥** (Category)
- é£Ÿå“
- è¡›ç”Ÿç”¨å“
- æ¸…æ½”ç”¨å“
- ç”Ÿæ´»ç”¨å“
- è¡£ç‰©
- é†«ç™‚ç”¨å“

### 2. **é ˜å–å–®ä½** (RecipientUnit)
- æ…ˆæ¿ŸåŸºé‡‘æœƒ
- ç´…åå­—æœƒ
- ä¸–ç•Œå±•æœ›æœƒ
- å‰µä¸–åŸºé‡‘æœƒ

### 3. **å–®ä½** (Unit)
åŒ…ã€ç½ã€ç›’ã€ç“¶ã€å€‹ã€å…¬æ–¤ã€ç‰‡ã€æ”¯ã€æ¢ã€è¢‹ã€ä»¶ã€çµ„ã€å…¬å‡

### 4. **åº«å­˜è®Šæ›´åŸå› ** (InventoryChangeReason)
- å¢åŠ åŸå› ï¼šå…¶ä»–ï¼ˆè«‹èªªæ˜ï¼‰
- æ¸›å°‘åŸå› ï¼šéæœŸã€æå£ã€éºå¤±ã€å…¶ä»–ï¼ˆè«‹èªªæ˜ï¼‰

### 5. **æ¨™æº–ç‰©è³‡å“é …** (StandardItem) â­
å¾ [public/item_list.json](../public/item_list.json) è‡ªå‹•åŒ¯å…¥ï¼ŒåŒ…å«ï¼š
- **é£Ÿå“** (14 é …)ï¼šéº¥ç‰‡ã€å…«å¯¶ç²¥ã€æ³¡éºµã€ç±³ã€æ²¹ç­‰
- **è¡›ç”Ÿç”¨å“** (8 é …)ï¼šå°¿å¸ƒã€å£ç½©ã€ç‰™åˆ·ã€è¡›ç”Ÿæ£‰ç­‰
- **æ¸…æ½”ç”¨å“** (8 é …)ï¼šè¡›ç”Ÿç´™ã€æ²æµ´éœ²ã€æ´—è¡£ç²¾ç­‰

æ¯å€‹å“é …åŒ…å«ï¼š
- åç¨±
- åˆ†é¡
- å¯ç”¨å–®ä½é™£åˆ— (å¦‚ï¼š`["åŒ…", "ç½", "ç›’"]`)
- é è¨­å–®ä½

### 6. **é è¨­æè´ˆäºº** (Donor)
- åŒ¿åæè´ˆè€…

---

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1: æ‰‹å‹•åŸ·è¡Œç¨®å­è…³æœ¬

```bash
npm run db:seed
```

### æ–¹å¼ 2: Prisma è‡ªå‹•ç¨®å­ (æ¨è–¦)

åœ¨åŸ·è¡Œ `prisma migrate reset` æˆ– `prisma db push` æ™‚ï¼ŒPrisma æœƒè‡ªå‹•åŸ·è¡Œç¨®å­è…³æœ¬ï¼š

```bash
# é‡ç½®è³‡æ–™åº«ä¸¦è‡ªå‹•ç¨®å­
npx prisma migrate reset

# æ¨é€ schema è®Šæ›´ (ä¸æœƒè‡ªå‹•ç¨®å­)
npx prisma db push
```

---

## ç¨®å­è…³æœ¬è¡Œç‚º

### ğŸ”„ **Upsert ç­–ç•¥**
StandardItem ä½¿ç”¨ `upsert`ï¼Œä¸æœƒåˆªé™¤æ—¢æœ‰è³‡æ–™ï¼š
- å¦‚æœå“é …å·²å­˜åœ¨ â†’ æ›´æ–° units å’Œ defaultUnit
- å¦‚æœå“é …ä¸å­˜åœ¨ â†’ å»ºç«‹æ–°å“é …

### ğŸ—‘ï¸ **æ¸…ç†ç­–ç•¥**
ä»¥ä¸‹è³‡æ–™æœƒåœ¨ç¨®å­å‰æ¸…ç©ºï¼ˆä½¿ç”¨ `deleteMany`ï¼‰ï¼š
- Category
- RecipientUnit
- Unit
- InventoryChangeReason

**ä¸æœƒæ¸…ç†**ï¼š
- StandardItem (ä½¿ç”¨ upsert)
- CustomItem (ä½¿ç”¨è€…è‡ªè¨‚è³‡æ–™)
- Donor (ä½¿ç”¨ upsert)
- DonationRecord (æ­·å²ç´€éŒ„)

---

## æ›´æ–°ç‰©è³‡æ¸…å–®

å¦‚æœéœ€è¦ä¿®æ”¹æ¨™æº–ç‰©è³‡å“é …ï¼š

1. **ç·¨è¼¯ä¾†æºæª”æ¡ˆ**
   ```bash
   vim public/item_list.json
   ```

2. **æ ¼å¼ç¯„ä¾‹**
   ```json
   {
     "é£Ÿå“": [
       {
         "item": "éº¥ç‰‡",
         "units": ["åŒ…", "ç½", "ç›’"],
         "defaultUnit": "åŒ…"
       }
     ]
   }
   ```

3. **é‡æ–°åŸ·è¡Œç¨®å­**
   ```bash
   npm run db:seed
   ```

---

## é©—è­‰ç¨®å­çµæœ

### ä½¿ç”¨ Prisma Studio
```bash
npx prisma studio
```

åœ¨ç€è¦½å™¨ä¸­é–‹å•Ÿ `http://localhost:5555`ï¼Œæª¢æŸ¥ï¼š
- StandardItem è¡¨æœ‰ 30 ç­†è³‡æ–™
- Donor è¡¨æœ‰ 1 ç­†ã€ŒåŒ¿åæè´ˆè€…ã€
- Category è¡¨æœ‰ 6 ç­†åˆ†é¡
- Unit è¡¨æœ‰ 13 ç­†å–®ä½

### ä½¿ç”¨ SQL æŸ¥è©¢
```sql
-- æŸ¥çœ‹æ¨™æº–ç‰©è³‡å“é …
SELECT name, category, units, "defaultUnit"
FROM "StandardItem"
ORDER BY category, name;

-- æŸ¥çœ‹æè´ˆäºº
SELECT * FROM "Donor";
```

---

## å¸¸è¦‹å•é¡Œ

### Q1: ç¨®å­å¤±æ•—ï¼Œé¡¯ç¤ºã€Œunique constraintã€éŒ¯èª¤
**åŸå› **: è³‡æ–™å·²å­˜åœ¨ï¼Œä¸”ä½¿ç”¨ `create` è€Œé `upsert`

**è§£æ±º**:
```bash
# é‡ç½®è³‡æ–™åº«
npx prisma migrate reset
```

### Q2: StandardItem çš„ units æ¬„ä½é¡¯ç¤ºç‚ºå­—ä¸²è€Œéé™£åˆ—
**åŸå› **: å¯èƒ½æ˜¯èˆŠç‰ˆç¨®å­è…³æœ¬åŸ·è¡Œçš„çµæœ

**è§£æ±º**:
```bash
# é‡æ–°åŸ·è¡Œç¨®å­
npm run db:seed
```

### Q3: æƒ³è¦å®Œå…¨æ¸…ç©ºè³‡æ–™åº«é‡ä¾†
```bash
# æ–¹å¼ 1: Prisma resetï¼ˆæ¨è–¦ï¼‰
npx prisma migrate reset

# æ–¹å¼ 2: æ‰‹å‹•æ¸…ç©º + æ¨é€ + ç¨®å­
npx prisma db push --force-reset
npm run db:seed
```

---

## ç¨®å­è…³æœ¬è¼¸å‡ºç¯„ä¾‹

```
ğŸŒ± é–‹å§‹ç¨®å­æ•¸æ“šå¡«å……...
ğŸ“¦ å‰µå»ºç‰©è³‡é¡åˆ¥...
ğŸ¢ å‰µå»ºé ˜å–å–®ä½...
ğŸ“ å‰µå»ºå–®ä½...
ğŸ“ å‰µå»ºåº«å­˜è®Šæ›´åŸå› ...
ğŸ“¦ å‰µå»ºæ¨™æº–ç‰©è³‡å“é …ï¼ˆStandardItemï¼‰...
   âœ“ é£Ÿå“ - éº¥ç‰‡ (å–®ä½: åŒ…/ç½/ç›’)
   âœ“ é£Ÿå“ - å…«å¯¶ç²¥ (å–®ä½: ç½)
   ...
ğŸ‘¤ å‰µå»ºé è¨­æè´ˆäºº...
   âœ“ åŒ¿åæè´ˆè€…

âœ… ç¨®å­æ•¸æ“šå¡«å……å®Œæˆï¼

ğŸ“Š å¡«å……çµæœ:
   - ç‰©è³‡é¡åˆ¥: 6 ç­†
   - é ˜å–å–®ä½: 4 ç­†
   - å–®ä½: 13 ç­†
   - åº«å­˜è®Šæ›´åŸå› : 5 ç­†
   - æ¨™æº–ç‰©è³‡å“é …: 30 ç­†
   - æè´ˆäºº: 1 ç­†
```

---

## ç›¸é—œæª”æ¡ˆ

- ç¨®å­è…³æœ¬ï¼š[prisma/seed.ts](../prisma/seed.ts)
- ç‰©è³‡æ¸…å–®ä¾†æºï¼š[public/item_list.json](../public/item_list.json)
- ç‰©è³‡æ¸…å–®æ–‡ä»¶ï¼š[docs/main_item.md](./main_item.md)
- Package é…ç½®ï¼š[package.json](../package.json#L10-L13)
